{%- block doctype -%}
<!DOCTYPE html>
{%- endblock %}
{%- set reldelim1 = reldelim1 is not defined and ' &rsaquo;' or reldelim1 %}
{%- set reldelim2 = reldelim2 is not defined and ' |' or reldelim2 %}
{%- set url_root = pathto('', 1) %}
{%- if url_root == '#' %}{% set url_root = '' %}{% endif %}
{% set project_abbreviation = 'ee' %}{% set project_domain = 'ellislab.com/expressionengine' %}
{%- if project == 'ExpressionEngine' %}{% set project_abbreviation = 'ee' %}{% set project_domain = 'ellislab.com/expressionengine' %}{% endif -%}

{%- set exclude_comments = ['index', 'license', 'changelog',
							'development/index', 'development/extension_hooks/index',
							'development/guidelines/template', 'development/developer_preview_program'] %}
{% if pagename in ['index', 'general/languages'] -%}
	{%- set script_files = script_files + ['_static/asset/js/jquery-github-repos.js'] %}
{% endif %}

<html>
	<head>
		<meta http-equiv="content-type" content="text/html" charset="utf-8" dir="ltr" lang="en-us">
	    {{ metatags }}
	    {%- if not embedded and docstitle %}
	      {%- set titlesuffix = " &mdash; "|safe + docstitle|e %}
	    {%- else %}
	      {%- set titlesuffix = "" %}
	    {%- endif %}
	    {%- block htmltitle %}
	    <title>{{ title|striptags|e }}{{ titlesuffix }}</title>
	    {%- endblock %}

	    <meta name="viewport" content="initial-scale=1">

	    <link rel="stylesheet" href="{{ pathto('_static/' + style, 1) }}" type="text/css" />


	    {%- for cssfile in css_files %}
	    <link rel="stylesheet" href="{{ pathto(cssfile, 1) }}" type="text/css" />
	    {%- endfor %}

    {%- if not embedded %}
	    <script type="text/javascript">
	      var DOCUMENTATION_OPTIONS = {
	        URL_ROOT:    '{{ url_root }}',
	        VERSION:     '{{ release|e }}',
	        COLLAPSE_INDEX: false,
	        FILE_SUFFIX: '{{ '' if no_search_suffix else file_suffix }}',
	        HAS_SOURCE:  {{ has_source|lower }}
	      };
	    </script>

	    {%- if favicon %}
	    <link rel="shortcut icon" href="{{ pathto('_static/' + favicon, 1) }}"/>
	    {%- endif %}
	{%- endif %}

	{%- block linktags %}
	    {%- if hasdoc('about') %}
	    <link rel="author" title="{{ _('About these documents') }}" href="{{ pathto('about') }}" />
	    {%- endif %}
	    {%- if hasdoc('genindex') %}
	    <link rel="index" title="{{ _('Index') }}" href="{{ pathto('genindex') }}" />
	    {%- endif %}
	    {%- if hasdoc('search') %}
	    <link rel="search" title="{{ _('Search') }}" href="{{ pathto('search') }}" />
	    {%- endif %}
	    {%- if hasdoc('copyright') %}
	    <link rel="copyright" title="{{ _('Copyright') }}" href="{{ pathto('copyright') }}" />
	    {%- endif %}
	    <link rel="top" title="{{ docstitle|e }}" href="{{ pathto('index') }}" />
	    {%- if parents %}
	    <link rel="up" title="{{ parents[-1].title|striptags|e }}" href="{{ parents[-1].link|e }}" />
	    {%- endif %}
	    {%- if next %}
	    <link rel="next" title="{{ next.title|striptags|e }}" href="{{ next.link|e }}" />
	    {%- endif %}
	    {%- if prev %}
	    <link rel="prev" title="{{ prev.title|striptags|e }}" href="{{ prev.link|e }}" />
	    {%- endif %}
	{%- endblock %}
		{%- block extrahead %} {% endblock %}
	</head>
	<body id="top">
		<section class="col-group">
			<section class="col w-16">
				<section class="docs-header">
					<h1>{{ project }}<b class="reg-mark">&reg;</b> {{ release }} User Guide</h1>
					<a class="small-menu" href="#"></a>
					<form class="search" method="get" action="https://www.google.com/search">
						<input type="text" name="q" id="q" placeholder="Search user guide...">
						<input type="hidden" name="as_sitesearch" id="as_sitesearch" value="{{ project_domain }}/user-guide/" />
					</form>
				</section>
			</section>
		</section>

		<section class="docs-content">

			<section class="col-group">
				<section class="col w-4">
					<div class="box sidebar">
						<h1>Welcome</h1>
						<form class="download">
							<select>
								<option>Download 3.x User Guide</option>
								<option>Download 2.x User Guide</option>
								<option>Download 1.x User Guide</option>
							</select>
						</form>
						<h1>What's New</h1>
							<h2><a href="{{ url_root }}development/conversion/index.html">Overview</a></h2>
								<ul>
									<li><a href="{{ url_root }}development/addon_setup_php_file.html">The addon.setup.php File</a></li>
									<li><a href="{{ url_root }}development/conversion/syntax.html">General Syntax Changes</a></li>
									<li><a href="{{ url_root }}development/cp_styles/index.html">Control Panel Pages</a></li>
									<li><a href="{{ url_root }}development/conversion/plugins.html">Plugin Specific Changes</a></li>
									<li><a href="{{ url_root }}development/conversion/modules.html">Module Specific Changes</a></li>
									<li><a href="{{ url_root }}development/guidelines/in-app-documentation.html">In-app Documentation</a></li>
								</ul>
							<h2><a href="{{ url_root }}development/conversion/walk-through.html">Add-on Conversion Walk-through</a></h2>
						<h1>Usage Guides</h1>
							<h2>Services</h2>
								<h3><a href="{{ url_root }}development/services/alert.html">Alert Service</a></h3>
								<h3>CP Services</h3>
									<ul>
										<li><a href="{{ url_root }}development/services/pagination.html">CP\Pagination Service</a></li>
										<li><a href="{{ url_root }}development/services/table.html">CP\Table Service</a></li>
										<li><a href="{{ url_root }}development/services/url.html">CP\URL Service</a></li>
									</ul>
								<h3><a href="{{ url_root }}development/services/event.html">Event Service</a></h3>
								<h3><a href="{{ url_root }}development/services/model.html">Model Service</a></h3>
									<ul>
										<li><a href="{{ url_root }}development/services/model/index.html">Using the Model Service</a></li>
										<li><a href="{{ url_root }}development/services/model/fetching.html">Fetching Models</a></li>
										<li><a href="{{ url_root }}development/services/model/relationships.html">Working with Relationships</a></li>
										<li><a href="{{ url_root }}development/services/building_models/index.html">Building your own Models</a></li>
									</ul>
								<h3><a href="{{ url_root }}development/services/validation.html">Validation Service</a></h3>
							<h2>Legacy</h2>
								<h3>API Classes</h3>
									<ul>
										<li><a href="{{ url_root }}development/legacy/api/api_channel_categories.html">Channel Categories API</a></li>
										<li><a href="{{ url_root }}development/legacy/api/api_channel_entries.html">Channel Entries API</a></li>
										<li><a href="{{ url_root }}development/legacy/api/api_channel_fields.html">Channel Fields API</a></li>
										<li><a href="{{ url_root }}development/legacy/api/api_channel_structure.html">Channel Structure API</a></li>
										<li><a href="{{ url_root }}development/legacy/api/api_template_structure.html">Template Structure</a></li>
									</ul>
								<h3>Libraries</h3>
									<ul>
										<li><a href="{{ url_root }}development/legacy/libraries/cache.html">Cache Class</a></li>
										<li><a href="{{ url_root }}development/legacy/libraries/cp.html">CP Class</a></li>
										<li><a href="{{ url_root }}development/legacy/libraries/database.html">Database Class</a></li>
										<li><a href="{{ url_root }}development/legacy/libraries/email.html">Email Class</a></li>
										<li><a href="{{ url_root }}development/legacy/libraries/file_field.html">File Field Class</a></li>
										<li><a href="{{ url_root }}development/legacy/libraries/form_validation.html">Form Validation Class</a></li>
										<li><a href="{{ url_root }}development/legacy/libraries/functions.html">Functions Class</a></li>
										<li><a href="{{ url_root }}development/legacy/libraries/input.html">Input Class</a></li>
										<li><a href="{{ url_root }}development/legacy/libraries/language.html">Language Class</a></li>
										<li><a href="{{ url_root }}development/legacy/libraries/layout.html">Layout Class</a></li>
										<li><a href="{{ url_root }}development/legacy/libraries/localization.html">Localization Class</a></li>
										<li><a href="{{ url_root }}development/legacy/libraries/logger.html">Logger Class</a></li>
										<li><a href="{{ url_root }}development/legacy/libraries/mime_type.html">Mime Type Class</a></li>
										<li><a href="{{ url_root }}development/legacy/libraries/pagination.html">Pagination Class</a></li>
										<li><a href="{{ url_root }}development/legacy/libraries/rss_parser.html">RSS Parser Class</a></li>
										<li><a href="{{ url_root }}development/legacy/libraries/security.html">Security Class</a></li>
										<li><a href="{{ url_root }}development/legacy/libraries/session.html">Session Class</a></li>
										<li><a href="{{ url_root }}development/legacy/libraries/table.html">Table Class</a></li>
										<li><a href="{{ url_root }}development/legacy/libraries/template.html">Template Class</a></li>
										<li><a href="{{ url_root }}development/legacy/libraries/typography.html">Typography Class</a></li>
										<li><a href="{{ url_root }}development/legacy/libraries/uri.html">URI Class</a></li>
										<li><a href="{{ url_root }}development/legacy/libraries/xmlparser.html">XML Parser Class</a></li>
									</ul>
								<h3><a href="{{ url_root }}development/legacy/helpers/index.html">Helpers</a></h3>
									<ul>
										<li><a href="{{ url_root }}development/legacy/helpers/array-helper.html">Array Helper</a></li>
										<li><a href="{{ url_root }}development/legacy/helpers/captcha-helper.html">CAPTCHA Helper</a></li>
										<li><a href="{{ url_root }}development/legacy/helpers/cookie-helper.html">Cookie Helper</a></li>
										<li><a href="{{ url_root }}development/legacy/helpers/custom-field-helper.html">Custom Field Helper</a></li>
										<li><a href="{{ url_root }}development/legacy/helpers/date-helper.html">Date Helper</a></li>
										<li><a href="{{ url_root }}development/legacy/helpers/directory-helper.html">Directory Helper</a></li>
										<li><a href="{{ url_root }}development/legacy/helpers/download-helper.html">Download Helper</a></li>
										<li><a href="{{ url_root }}development/legacy/helpers/email-helper.html">Email Helper</a></li>
										<li><a href="{{ url_root }}development/legacy/helpers/file-helper.html">File Helper</a></li>
										<li><a href="{{ url_root }}development/legacy/helpers/form-helper.html">Form Helper</a></li>
										<li><a href="{{ url_root }}development/legacy/helpers/html-helper.html">HTML Helper</a></li>
										<li><a href="{{ url_root }}development/legacy/helpers/inflector-helper.html">Inflector Helper</a></li>
										<li><a href="{{ url_root }}development/legacy/helpers/language-helper.html">Language Helper</a></li>
										<li><a href="{{ url_root }}development/legacy/helpers/number-helper.html">Number Helper</a></li>
										<li><a href="{{ url_root }}development/legacy/helpers/path-helper.html">Path Helper</a></li>
										<li><a href="{{ url_root }}development/legacy/helpers/quicktab-helper.html">Quicktab Helper</a></li>
										<li><a href="{{ url_root }}development/legacy/helpers/search-helper.html">Search Helper</a></li>
										<li><a href="{{ url_root }}development/legacy/helpers/security-helper.html">Security Helper</a></li>
										<li><a href="{{ url_root }}development/legacy/helpers/segment-helper.html">Segment Helper</a></li>
										<li><a href="{{ url_root }}development/legacy/helpers/smiley-helper.html">Smiley Helper</a></li>
										<li><a href="{{ url_root }}development/legacy/helpers/snippets-helper.html">Snippets Helper</a></li>
										<li><a href="{{ url_root }}development/legacy/helpers/spellcheck-helper.html">Spellcheck Helper</a></li>
										<li><a href="{{ url_root }}development/legacy/helpers/string-helper.html">String Helper</a></li>
										<li><a href="{{ url_root }}development/legacy/helpers/text-helper.html">Text Helper</a></li>
										<li><a href="{{ url_root }}development/legacy/helpers/typography-helper.html">Typography Helper</a></li>
										<li><a href="{{ url_root }}development/legacy/helpers/url-helper.html">URL Helper</a></li>
										<li><a href="{{ url_root }}development/legacy/helpers/view-helper.html">View Helper</a></li>
										<li><a href="{{ url_root }}development/legacy/helpers/xml-helper.html">XML Helper</a></li>
										<li><a href="{{ url_root }}development/legacy/helpers/xss-helper.html">XSS Helper</a></li>
									</ul>
						<h1>API Reference (coming soon)</h1>
						<h1>Stubs / Todos</h1>
							<h2><a href="{{ url_root }}todos.html">Documentation Todo list</a></h2>

						<!-- @todo organize and add table of contents -->
					</div>
				</section>
	{%- block content %}
				<section class="col w-12 content-main">
					<ul class="breadcrumb">
						{%- block rootrellink %}
						<li><a href="{{ pathto(master_doc) }}">Home</a></li>
						{%- endblock %}

						{%- for parent in parents %}
						<li><a href="{{ parent.link|e }}" {% if loop.last %}{{ accesskey("U") }}{% endif %}>{{ parent.title }}</a></li>
				        {%- endfor %}

						{%- if pagename != 'index' %}
						<li class="last">{{ title }}</li>
						{%- endif %}
					</ul>

					{{ body }}
	{%- endblock %}
				</section>
			</section>

		{% if pagename not in exclude_comments -%}
		<!-- {user_guide_comments} -->
		{% endif %}

			</section><!-- / docs-content -->

		{%- block footer %}
		<section class="col-group">
			<section class="col w-16">
				<section class="docs-footer">
					<p>{{ project }}<b class="reg-mark">&reg;</b> {{ release }} User Guide<br><span>{{ copyright }}</span></p>
					<p><a class="scroll" href="#top"></a></p>
				</section>
			</section>
		</section>
		{%- endblock %}

		{%- for scriptfile in script_files %}
		<script type="text/javascript" src="{{ pathto(scriptfile, 1) }}"></script>
		{%- endfor %}
	</body>
</html>
